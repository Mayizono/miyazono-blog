<!-- build time:Wed Sep 29 2021 21:08:01 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="冬樱茶" href="https://github.com/Mayizono/miyazono.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="冬樱茶" href="https://github.com/Mayizono/miyazono.github.io/atom.xml"><link rel="alternate" type="application/json" title="冬樱茶" href="https://github.com/Mayizono/miyazono.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><link rel="canonical" href="https://github.com/Mayizono/miyazono.github.io/big-data/flink/2_Canal/"><title>CDC Canal 的使用 - Flink - 大数据 | Yume Shoka = 冬樱茶</title><meta name="generator" content="Hexo 5.4.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">CDC Canal 的使用</h1><div class="meta"><span class="item" title="创建时间：2021-01-09 00:00:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2021-01-09T00:00:00+08:00">2021-01-09</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>10k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>9 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Yume Shoka</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gicm07ih54j20zk0m84qp.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gicliwyw55j20zk0m8hdt.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclgi503lj20zk0m8hdt.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipeyonbf9j20zk0m8e81.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gicmnywqgpj20zk0m8dwx.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclil3m4ej20zk0m8tn8.jpg"></li></ul></div><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div></header><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/big-data/" itemprop="item" rel="index" title="分类于 大数据"><span itemprop="name">大数据</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/big-data/flink/" itemprop="item" rel="index" title="分类于 Flink"><span itemprop="name">Flink</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://github.com/Mayizono/miyazono.github.io/big-data/flink/2_Canal/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Miyazono"><meta itemprop="description" content=", "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="冬樱茶"></span><div class="body md" itemprop="articleBody"><h2 id="canal入门"><a class="anchor" href="#canal入门">#</a> Canal 入门</h2><h3 id="什么是canal"><a class="anchor" href="#什么是canal">#</a> 什么是 Canal</h3><p>阿里巴巴 B2B 公司，因为业务的特性，卖家主要集中在国内，买家主要集中在国外，所以衍生出了同步杭州和美国异地机房的需求，从 2010 年开始，阿里系公司开始逐步的尝试基于数据库的日志解析，获取增量变更进行同步，由此衍生出了增量订阅 &amp; 消费的业务。</p><p>Canal 是用 java 开发的基于数据库增量日志解析，提供增量数据订阅 &amp; 消费的中间件。目前，Canal 主要支持了 MySQL 的 Binlog 解析，解析完成后才利用 Canal Client 来处理获得的相关数据。（数据库同步需要阿里的 Otter 中间件，基于 Canal）。</p><h3 id="使用场景"><a class="anchor" href="#使用场景">#</a> 使用场景</h3><p>(1) 原始场景： 阿里 Otter 中间件的一部分</p><p>Otter 是阿里用于进行异地数据库之间的同步框架，Canal 是其中一部分。</p><p><img data-src="C:/Users/ADMINI~1/AppData/Local/Temp/ksohtml9320/wps1.jpg" alt="img"></p><p>(2) 常见场景 1：更新缓存</p><p><img data-src="C:/Users/ADMINI~1/AppData/Local/Temp/ksohtml9320/wps2.jpg" alt="img"></p><p>(3) 常见场景 2：抓取业务数据新增变化表，用于制作拉链表。</p><p>(4) <strong>常见场景 3：抓取业务表的新增变化数据，用于制作实时统计（我们就是这种场景）</strong></p><h3 id="canal的工作原理"><a class="anchor" href="#canal的工作原理">#</a> Canal 的工作原理</h3><ol><li><h3 id="mysql主从复制过程"><a class="anchor" href="#mysql主从复制过程">#</a> MySQL 主从复制过程</h3></li></ol><ul><li>Master 主库将改变记录，写到二进制日志 (Binary log) 中</li><li>Slave 从库向 mysql master 发送 dump 协议，将 master 主库的 binary log events 拷贝到它的中继日志 (relay log)</li><li>Slave 从库读取并重做中继日志中的事件，将改变的数据同步到自己的数据库。</li></ul><p><img data-src="C:/Users/ADMINI~1/AppData/Local/Temp/ksohtml9320/wps3.jpg" alt="img"></p><ol start="2"><li><h3 id="canal的工作原理-2"><a class="anchor" href="#canal的工作原理-2">#</a> Canal 的工作原理</h3></li></ol><p>很简单，就是<strong>把自己伪装成 Slave，假装从 Master 复制数据</strong></p><p><img data-src="C:/Users/ADMINI~1/AppData/Local/Temp/ksohtml9320/wps4.jpg" alt="img"></p><h3 id="mysql的binlog"><a class="anchor" href="#mysql的binlog">#</a> MySQL 的 Binlog</h3><ol><li>什么是 Binlog</li></ol><p>MySQL 的二进制日志可以说 MySQL 最重要的日志了，它记录了所有的 DDL 和 DML (除了数据查询语句) 语句，以事件形式记录，还包含语句所执行的消耗的时间，MySQL 的二进制日志是事务安全型的。</p><p>一般来说开启二进制日志大概会有 1% 的性能损耗。二进制有两个最重要的使用场景:</p><ul><li>其一：MySQL Replication 在 Master 端开启 Binlog，Master 把它的二进制日志传递给 Slaves 来达到 Master-Slave 数据一致的目的。</li><li>其二：自然就是数据恢复了，通过使用 MySQL Binlog 工具来使恢复数据。</li></ul><blockquote><p>二进制日志包括两类文件：二进制日志索引文件（文件名后缀为.index）用于记录所有的二进制文件，二进制日志文件（文件名后缀为.00000*）记录数据库所有的 DDL 和 DML (除了数据查询语句) 语句事件。</p></blockquote><ol start="2"><li>Binlog 的开启</li></ol><ul><li><p>找到 MySQL 配置文件的位置</p></li><li><p>Linux: /etc/my.cnf</p></li></ul><p>如果 /etc 目录下没有，可以通过 locate my.cnf 查找位置</p><ul><li><p>Windows: \my.ini</p></li><li><p>在 mysql 的配置文件下，修改配置</p></li></ul><p>在 [mysqld] 区块，设置 / 添加 log-bin=mysql-bin</p><p>这个表示 binlog 日志的前缀是 mysql-bin，以后生成的日志文件就是 mysql-bin.123456 的文件后面的数字按顺序生成，每次 mysql 重启或者到达单个文件大小的阈值时，新生一个文件，按顺序编号。</p><ol start="3"><li>Binlog 的分类设置</li></ol><p>mysql binlog 的格式有三种，分别是 STATEMENT,MIXED,ROW。</p><p>在配置文件中可以选择配置	binlog_format= statement|mixed|row</p><ul><li><p>三种格式的区别：</p></li><li><p><strong>statement</strong></p><p>语句级，binlog 会记录每次一执行写操作的语句。</p><p>相对 row 模式节省空间，但是可能产生不一致性，比如</p><p>update tt set create_date=now()</p><p>如果用 binlog 日志进行恢复，由于执行时间不同可能产生的数据就不同。</p><p>优点： 节省空间缺点： 有可能造成数据不一致。</p></li><li><p><strong>row</strong></p></li></ul><p>​ 行级， binlog 会记录每次操作后每行记录的变化。</p><p>​ 优点：保持数据的绝对一致性。因为不管 sql 是什么，引用了什么函数，他只记录执行后的效果。</p><p>​ 缺点：占用较大空间。</p><ul><li><strong>mixed</strong></li></ul><p>​ statement 的升级版，一定程度上解决了，因为一些情况而造成的 statement 模式不一致问题</p><p>​ 默认还是 statement，在某些情况下譬如：</p><p>​ 当函数中包含 UUID () 时；</p><p>​ 包含 AUTO_INCREMENT 字段的表被更新时；</p><p>​ 执行 INSERT DELAYED 语句时；</p><p>​ 用 UDF 时；</p><p>​ 会按照 ROW 的方式进行处理</p><p>​ 优点：节省空间，同时兼顾了一定的一致性。</p><p>​ 缺点：还有些极个别情况依旧会造成不一致，另外 statement 和 mixed 对于需要对 binlog 的监控的情况都不方便。</p><p><strong>综合上面对比，Cannel 想做监控分析，选择 row 格式比较合适</strong></p><h2 id="mysql的准备"><a class="anchor" href="#mysql的准备">#</a> MySQL 的准备</h2><h3 id="创建实时业务数据库"><a class="anchor" href="#创建实时业务数据库">#</a> 创建实时业务数据库</h3><p><img data-src="C:/Users/ADMINI~1/AppData/Local/Temp/ksohtml9320/wps5.jpg" alt="img"></p><h3 id="导入建表数据"><a class="anchor" href="#导入建表数据">#</a> 导入建表数据</h3><p><img data-src="C:/Users/ADMINI~1/AppData/Local/Temp/ksohtml9320/wps6.jpg" alt="img"></p><h3 id="修改etcmycnf文件"><a class="anchor" href="#修改etcmycnf文件">#</a> 修改 /etc/my.cnf 文件</h3><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>atguigu@hadoop102 module<span class="token punctuation">]</span>$ <span class="token function">sudo</span> <span class="token function">vim</span> /etc/my.cnf</pre></td></tr><tr><td data-num="2"></td><td><pre>server-id<span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="3"></td><td><pre>log-bin<span class="token operator">=</span>mysql-bin</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token assign-left variable">binlog_format</span><span class="token operator">=</span>row</pre></td></tr><tr><td data-num="5"></td><td><pre>binlog-do-db<span class="token operator">=</span>gmall2020</pre></td></tr></table></figure><blockquote><p><strong>注意：binlog-do-db 根据自己的情况进行修改，指定具体要同步的数据库</strong></p></blockquote><h3 id="824-重启mysql使配置生效"><a class="anchor" href="#824-重启mysql使配置生效">#</a> <strong>8</strong>**.2.4** <strong>重启 M<strong><strong>y</strong></strong>SQL 使配置生效</strong></h3><p>sudo systemctl restart mysqld</p><p>到 /var/lib/mysql 目录下查看初始文件大小 154</p><p><img data-src="C:/Users/ADMINI~1/AppData/Local/Temp/ksohtml9320/wps7.jpg" alt="img"></p><h3 id="825-模拟生成数据"><a class="anchor" href="#825-模拟生成数据">#</a> <strong>8</strong>**.2.5** <strong>模拟生成数据</strong></h3><p>Ø 把 / 2. 资料 / 03 - 模拟器 (数据库) 里面的 jar 和 properties 文件上传到 /opt/module/rt_dblog 目录下</p><p>Ø 修改 application.properties 中数据库连接信息</p><p><img data-src="C:/Users/ADMINI~1/AppData/Local/Temp/ksohtml9320/wps8.jpg" alt="img"></p><p>Ø 运行 jar 包</p><p>[atguigu@hadoop102 rt_dblog]$ java -jar gmall2020-mock-db-2020-05-18.jar</p><p><img data-src="C:/Users/ADMINI~1/AppData/Local/Temp/ksohtml9320/wps9.jpg" alt="img"></p><p>Ø 再次到到 /var/lib/mysql 目录下，查看 index 文件的大小</p><p><img data-src="C:/Users/ADMINI~1/AppData/Local/Temp/ksohtml9320/wps10.jpg" alt="img"></p><h3 id="826-赋权限"><a class="anchor" href="#826-赋权限">#</a> <strong>8</strong>**.2.6** <strong>赋权限</strong></h3><p>在 mysql 中执行</p><p>mysql&gt; set global validate_password_length=4;</p><p>mysql&gt; set global validate_password_policy=0;</p><p>mysql&gt; GRANT SELECT, REPLICATION SLAVE, REPLICATION CLIENT ON <em>.</em> TO 'canal'@'%' IDENTIFIED BY 'canal' ;</p><h2 id="83-canal-架构以及安装"><a class="anchor" href="#83-canal-架构以及安装">#</a> <strong>8.3</strong> <strong>canal</strong> <strong>架构以及安装</strong></h2><h3 id="831-canal架构"><a class="anchor" href="#831-canal架构">#</a> <strong>8.3.1</strong> <strong>canal 架构</strong></h3><p><img data-src="C:/Users/ADMINI~1/AppData/Local/Temp/ksohtml9320/wps11.jpg" alt="img"></p><h3 id="832-canal的下载和安装"><a class="anchor" href="#832-canal的下载和安装">#</a> <strong>8.3.2</strong> <strong>canal 的下载和安装</strong></h3><p><a href="https://github.com/alibaba/canal/releases">https://github.com/alibaba/canal/releases</a></p><p>我们直接 / 2. 资料 / 02 - 工具下的 canal.deployer-1.1.4.tar.gz 拷贝到 /opt/sortware 目录下，然后解压到 /opt/module/canal 包下</p><p><strong>注意：canal 解压后是散的，我们在指定解压目录的时候需要将 canal 指定上</strong></p><p>[atguigu@hadoop102 software]$ mkdir /opt/module/canal</p><p>[atguigu@hadoop102 software]$ tar -zxvf canal.deployer-1.1.4.tar.gz -C /opt/module/canal</p><h2 id="84-canal单机版"><a class="anchor" href="#84-canal单机版">#</a> <strong>8.4</strong> <strong>canal 单机版</strong></h2><h3 id="841-修改confcanalproperties的配置"><a class="anchor" href="#841-修改confcanalproperties的配置">#</a> <strong>8</strong>**.4.1** <strong>修改<strong><strong> conf/canal.properties</strong></strong> 的配置</strong></h3><p>[atguigu@hadoop102 conf]$ pwd</p><p>/opt/module/canal/conf</p><p>[atguigu@hadoop102 conf]$ vim canal.properties</p><p>Ø 这个文件是 canal 的基本通用配置，canal 端口号默认就是 11111</p><p>Ø 修改 canal 的输出 model，默认 tcp，改为输出到 kafka</p><p><img data-src="C:/Users/ADMINI~1/AppData/Local/Temp/ksohtml9320/wps12.jpg" alt="img"></p><p>tcp 就是输出到 canal 客户端，通过编写 Java 代码处理</p><p>Ø 修改 Kafka 集群的地址</p><p><img data-src="C:/Users/ADMINI~1/AppData/Local/Temp/ksohtml9320/wps13.jpg" alt="img"></p><p>Ø 如果创建多个实例</p><p>通过前面 canal 架构，我们可以知道，一个 canal 服务中可以有多个 instance，conf / 下的每一个 example 即是一个实例，每个实例下面都有独立的配置文件。默认只有一个实例 example，如果需要多个实例处理不同的 MySQL 数据的话，直接拷贝出多个 example，并对其重新命名，命名和配置文件中指定的名称一致，然后修改 canal.properties 中的 canal.destinations = 实例 1，实例 2，实例 3。</p><p><img data-src="C:/Users/ADMINI~1/AppData/Local/Temp/ksohtml9320/wps14.jpg" alt="img"></p><h3 id="842-修改instanceproperties"><a class="anchor" href="#842-修改instanceproperties">#</a> <strong>8</strong>**.4.2** <strong>修改 instance.properties</strong></h3><p>我们这里只读取一个 MySQL 数据，所以只有一个实例，这个实例的配置文件在 conf/example 目录下</p><p>[atguigu@hadoop102 example]$ pwd</p><p>/opt/module/canal/conf/example</p><p>[atguigu@hadoop102 example]$ vim instance.properties</p><p>Ø 配置 MySQL 服务器地址</p><p><img data-src="C:/Users/ADMINI~1/AppData/Local/Temp/ksohtml9320/wps15.jpg" alt="img"></p><p>Ø 配置连接 MySQL 的用户名和密码，默认就是我们前面授权的 canal</p><p><img data-src="C:/Users/ADMINI~1/AppData/Local/Temp/ksohtml9320/wps16.jpg" alt="img"></p><p>Ø 修改输出到 Kafka 的主题以及分区数</p><p><img data-src="C:/Users/ADMINI~1/AppData/Local/Temp/ksohtml9320/wps17.jpg" alt="img"></p><p>注意：默认还是输出到指定 Kafka 主题的一个 kafka 分区，因为多个分区并行可能会打乱 binlog 的顺序</p><p>如果要提高并行度，首先设置 kafka 的分区数 &gt; 1, 然后设置 canal.mq.partitionHash 属性</p><h3 id="843-单机canal测试"><a class="anchor" href="#843-单机canal测试">#</a> <strong>8</strong>**.4.3** <strong>单机 canal 测试</strong></h3><p>Ø 启动 canal</p><p>[atguigu@hadoop102 example]$ cd /opt/module/canal/</p><p>[atguigu@hadoop102 canal]$ bin/startup.sh</p><p>看到 CanalLauncher 你表示启动成功，同时会创建 gmall2020_db_c 主题</p><p><img data-src="C:/Users/ADMINI~1/AppData/Local/Temp/ksohtml9320/wps18.jpg" alt="img"></p><p>Ø 启动 Kafka 消费客户端测试，查看消费情况</p><p>[atguigu@hadoop102 kafka]$ bin/kafka-console-consumer.sh --bootstrap-server hadoop102:9092 --topic gmall2020_db_c</p><p>Ø 运行 /opt/module/rt_dblog 中生成模拟数据</p><p><img data-src="C:/Users/ADMINI~1/AppData/Local/Temp/ksohtml9320/wps19.jpg" alt="img"></p><h2 id="85-canal高可用了解"><a class="anchor" href="#85-canal高可用了解">#</a> <strong>8.5</strong> <strong>canal 高可用（了解）</strong></h2><p>这种 zookeeper 为观察者监控的模式，<strong>只能实现高可用，而不是负载均衡</strong>，即同一时点只有一个 canal-server 节点能够监控某个数据源，只要这个节点能够正常工作，那么其他监控这个数据源的 canal-server 只能做 stand-by，直到工作节点停掉，其他 canal-server 节点才能抢占。因为有一个 stand-by 也要占用资源，同时 canal 传输数据宕机的情况也比较少，所以好多企业是不配置 canal 的高可用的。</p><h3 id="851-停止单机canal进程"><a class="anchor" href="#851-停止单机canal进程">#</a> <strong>8</strong>**.5.1** <strong>停止单机 canal 进程</strong></h3><p><img data-src="C:/Users/ADMINI~1/AppData/Local/Temp/ksohtml9320/wps20.jpg" alt="img"></p><h3 id="852-在hadoop102上修改canalproperties"><a class="anchor" href="#852-在hadoop102上修改canalproperties">#</a> <strong>8</strong>**.5.2** <strong>在 hadoop102 上修改 canal.properties</strong></h3><p>Ø 配置 zookeeper</p><p><img data-src="C:/Users/ADMINI~1/AppData/Local/Temp/ksohtml9320/wps21.jpg" alt="img"></p><p>Ø 避免发送重复数据（否则在切换 active 的时候会重复发送数据）</p><p><img data-src="C:/Users/ADMINI~1/AppData/Local/Temp/ksohtml9320/wps22.jpg" alt="img"></p><h3 id="853-把canal目录分发给其他虚拟机"><a class="anchor" href="#853-把canal目录分发给其他虚拟机">#</a> <strong>8</strong>**.5.3** <strong>把 c<strong><strong>anal</strong></strong> 目录分发给其他虚拟机</strong></h3><p>[atguigu@hadoop102 module]$ xsync canal/</p><h3 id="854-测试"><a class="anchor" href="#854-测试">#</a> <strong>8</strong>**.5.4** <strong>测试</strong></h3><p>Ø 先在 hadoop102 启动 canal，再在 hadoop103 上启动 canal</p><p>[atguigu@hadoop102 canal]$ bin/startup.sh</p><p>Ø 启动 kafka 消费客户端</p><p>[atguigu@hadoop102 kafka]$ bin/kafka-console-consumer.sh --bootstrap-server hadoop102:9092 --topic gmall2021_db_c</p><p>Ø 在数据库 gmall2021 随便一张表中修改一条数据，查看效果</p><p>Ø 挂掉 102 再次修改数据，查看效果</p><h2 id="86-maxwell与canal-工具对比"><a class="anchor" href="#86-maxwell与canal-工具对比">#</a> <strong>8.6 Maxwell<strong><strong> 与</strong></strong> Canal</strong> <strong>工具对比</strong></h2><p>Ø Maxwell 没有 Canal 那种 server+client 模式，只有一个 server 把数据发送到消息队列或 redis。</p><p>Ø Maxwell 有一个亮点功能，就是 Canal 只能抓取最新数据，对已存在的历史数据没有办法处理。而 Maxwell 有一个 bootstrap 功能，可以直接引导出完整的历史数据用于初始化，非常好用。</p><p>Ø Maxwell 不能直接支持 HA，但是它支持断点还原，即错误解决后重启继续上次点儿读取数据。</p><p>Ø Maxwell 只支持 json 格式，而 Canal 如果用 Server+client 模式的话，可以自定义格式。</p><p>Ø Maxwell 比 Canal 更加轻量级。</p><h3 id="861执行不同操作maxwell和canal数据格式对比"><a class="anchor" href="#861执行不同操作maxwell和canal数据格式对比">#</a> <strong>8</strong>**.6.1**** 执行不同操作，Maxwell 和 canal 数据格式对比 **</h3><p>Ø 执行 insert 测试语句</p><p>INSERT INTO z_user_info VALUES(30,'zhang3','13810001010'),(31,'li4','1389999999');</p><table><thead><tr><th><em><strong>*c*</strong></em><em><strong>*anal*</strong></em></th><th><em><strong>*m*</strong></em><em><strong>*axwell*</strong></em></th></tr></thead><tbody><tr><td><em><strong>*{&quot;data&quot;😗</strong></em><em><strong>*[{&quot;id&quot;:&quot;30&quot;,&quot;user_name&quot;:&quot;zhang3&quot;,&quot;tel&quot;:&quot;13810001010&quot;},{&quot;id&quot;😗</strong></em><em><strong>*&quot;31&quot;*</strong></em><em><strong>*,&quot;user_name&quot;:&quot;li4&quot;,&quot;tel&quot;:&quot;1389999999&quot;}]*</strong></em><em><strong>*,&quot;database&quot;:&quot;gmall-2020-04&quot;,&quot;es&quot;:1589385314000,&quot;id&quot;:2,&quot;isDdl&quot;:false,&quot;mysqlType&quot;:{&quot;id&quot;:&quot;bigint(20)&quot;,&quot;user_name&quot;:&quot;varchar(20)&quot;,&quot;tel&quot;:&quot;varchar(20)&quot;},&quot;old&quot;:null,&quot;pkNames&quot;:[&quot;id&quot;],&quot;sql&quot;:&quot;&quot;,&quot;sqlType&quot;:{&quot;id&quot;:-5,&quot;user_name&quot;:12,&quot;tel&quot;:12},&quot;table&quot;:&quot;z_user_info&quot;,&quot;ts&quot;:1589385314116,&quot;type&quot;:&quot;INSERT&quot;}*</strong></em></td><td>{&quot;database&quot;:&quot;gmall-2020-04&quot;,&quot;table&quot;:&quot;z_user_info&quot;,&quot;type&quot;:&quot;insert&quot;,&quot;ts&quot;:1589385314,&quot;xid&quot;:82982,&quot;xoffset&quot;:0,&quot;data&quot;:{&quot;id&quot;:<em><strong>*30*</strong></em>,&quot;user_name&quot;:&quot;zhang3&quot;,&quot;tel&quot;:&quot;13810001010&quot;}} {&quot;database&quot;:&quot;gmall-2020-04&quot;,&quot;table&quot;:&quot;z_user_info&quot;,&quot;type&quot;:&quot;insert&quot;,&quot;ts&quot;:1589385314,&quot;xid&quot;:82982,&quot;commit&quot;:true,&quot;data&quot;:{&quot;id&quot;:31,&quot;user_name&quot;:&quot;li4&quot;,&quot;tel&quot;:&quot;1389999999&quot;}}</td></tr></tbody></table><p>Ø 执行 update 操作</p><p>UPDATE z_user_info SET <code>user_name</code> ='wang55' WHERE id IN(30,31)</p><table><thead><tr><th><em><strong>*c*</strong></em><em><strong>*anal*</strong></em></th><th><em><strong>*m*</strong></em><em><strong>*axwell*</strong></em></th></tr></thead><tbody><tr><td><em><strong>*{&quot;data&quot;😗</strong></em><em><strong>*[{&quot;id&quot;:&quot;30&quot;,&quot;user_name&quot;:&quot;wang55&quot;,&quot;tel&quot;:&quot;13810001010&quot;},{&quot;id&quot;😗</strong></em><em><strong>*&quot;31&quot;*</strong></em><em><strong>*,&quot;user_name&quot;:&quot;wang55&quot;,&quot;tel&quot;:&quot;1389999999&quot;}]*</strong></em><em><strong>*,&quot;database&quot;:&quot;gmall-2020-04&quot;,&quot;es&quot;:1589385508000,&quot;id&quot;:3,&quot;isDdl&quot;:false,&quot;mysqlType&quot;:{&quot;id&quot;:&quot;bigint(20)&quot;,&quot;user_name&quot;:&quot;varchar(20)&quot;,&quot;tel&quot;:&quot;varchar(20)&quot;},&quot;old&quot;:[{&quot;user_name&quot;:&quot;zhang3&quot;},{&quot;user_name&quot;:&quot;li4&quot;}],&quot;pkNames&quot;:[&quot;id&quot;],&quot;sql&quot;:&quot;&quot;,&quot;sqlType&quot;:{&quot;id&quot;:-5,&quot;user_name&quot;:12,&quot;tel&quot;:12},&quot;table&quot;:&quot;z_user_info&quot;,&quot;ts&quot;:1589385508676,&quot;type&quot;:&quot;UPDATE&quot;}*</strong></em></td><td>{&quot;database&quot;:&quot;gmall-2020-04&quot;,&quot;table&quot;:&quot;z_user_info&quot;,&quot;type&quot;:&quot;update&quot;,&quot;ts&quot;:1589385508,&quot;xid&quot;:83206,&quot;xoffset&quot;:0,&quot;data&quot;:{&quot;id&quot;:30,&quot;user_name&quot;:&quot;wang55&quot;,&quot;tel&quot;:&quot;13810001010&quot;},&quot;old&quot;:{&quot;user_name&quot;:&quot;zhang3&quot;}} {&quot;database&quot;:&quot;gmall-2020-04&quot;,&quot;table&quot;:&quot;z_user_info&quot;,&quot;type&quot;:&quot;update&quot;,&quot;ts&quot;:1589385508,&quot;xid&quot;:83206,&quot;commit&quot;:true,&quot;data&quot;:{&quot;id&quot;:31,&quot;user_name&quot;:&quot;wang55&quot;,&quot;tel&quot;:&quot;1389999999&quot;},&quot;old&quot;:{&quot;user_name&quot;:&quot;li4&quot;}}</td></tr></tbody></table><p>Ø delete 操作</p><p>DELETE FROM z_user_info WHERE id IN(30,31)</p><table><thead><tr><th><em><strong>*c*</strong></em><em><strong>*anal*</strong></em></th><th><em><strong>*m*</strong></em><em><strong>*axwell*</strong></em></th></tr></thead><tbody><tr><td><em><strong>*{&quot;data&quot;😗</strong></em><em><strong>*[{&quot;id&quot;😗</strong></em><em><strong>*&quot;30&quot;*</strong></em><em><strong>*,&quot;user_name&quot;:&quot;wang55&quot;,&quot;tel&quot;:&quot;13810001010&quot;},{&quot;id&quot;:&quot;31&quot;,&quot;user_name&quot;:&quot;wang55&quot;,&quot;tel&quot;:&quot;1389999999&quot;}]*</strong></em><em><strong>*,&quot;database&quot;:&quot;gmall-2020-04&quot;,&quot;es&quot;:1589385644000,&quot;id&quot;:4,&quot;isDdl&quot;:false,&quot;mysqlType&quot;:{&quot;id&quot;:&quot;bigint(20)&quot;,&quot;user_name&quot;:&quot;varchar(20)&quot;,&quot;tel&quot;:&quot;varchar(20)&quot;},&quot;old&quot;:null,&quot;pkNames&quot;:[&quot;id&quot;],&quot;sql&quot;:&quot;&quot;,&quot;sqlType&quot;:{&quot;id&quot;:-5,&quot;user_name&quot;:12,&quot;tel&quot;:12},&quot;table&quot;:&quot;z_user_info&quot;,&quot;ts&quot;:1589385644829,&quot;type&quot;:&quot;DELETE&quot;}*</strong></em></td><td>{&quot;database&quot;:&quot;gmall-2020-04&quot;,&quot;table&quot;:&quot;z_user_info&quot;,&quot;type&quot;:&quot;delete&quot;,&quot;ts&quot;:1589385644,&quot;xid&quot;:83367,&quot;xoffset&quot;:0,&quot;data&quot;:{&quot;id&quot;:30,&quot;user_name&quot;:&quot;wang55&quot;,&quot;tel&quot;:&quot;13810001010&quot;}} {&quot;database&quot;:&quot;gmall-2020-04&quot;,&quot;table&quot;:&quot;z_user_info&quot;,&quot;type&quot;:&quot;delete&quot;,&quot;ts&quot;:1589385644,&quot;xid&quot;:83367,&quot;commit&quot;:true,&quot;data&quot;:{&quot;id&quot;:31,&quot;user_name&quot;:&quot;wang55&quot;,&quot;tel&quot;:&quot;1389999999&quot;}}</td></tr></tbody></table><h3 id="862-总结数据特点"><a class="anchor" href="#862-总结数据特点">#</a> <strong>8</strong>**.6.2** <strong>总结数据特点</strong></h3><p><strong>Ø</strong> <em><strong>* 日志结构 *</strong></em></p><p>canal 每一条 SQL 会产生一条日志，如果该条 Sql 影响了多行数据，则已经会通过集合的方式归集在这条日志中。（即使是一条数据也会是数组结构）</p><p>maxwell 以影响的数据为单位产生日志，即每影响一条数据就会产生一条日志。如果想知道这些日志是否是通过某一条 sql 产生的可以通过 xid 进行判断，相同的 xid 的日志来自同一 sql。</p><p><strong>Ø</strong> <em><strong>* 数字类型 *</strong></em></p><p>当原始数据是数字类型时，maxwell 会尊重原始数据的类型不增加双引，变为字符串。canal 一律转换为字符串。</p><p><strong>Ø</strong> <em><strong>* 带原始数据字段定义 *</strong></em></p><p>canal 数据中会带入表结构。maxwell 更简洁。</p><h2 id="87-maxwell的初始化数据功能"><a class="anchor" href="#87-maxwell的初始化数据功能">#</a> <strong>8.7</strong> <strong>Maxwell 的初始化数据功能</strong></h2><p><strong>例如：初始化用户表</strong></p><p>bin/maxwell-bootstrap --user maxwell --password 000000 --host hadoop102 --database gmall2021 --table user_info --client_id maxwell_1</p><p>Ø --user maxwell</p><p>数据库分配的操作 maxwell 数据库的用户名</p><p>Ø --password 000000</p><p>数据库分配的操作 maxwell 数据库的密码</p><p>Ø --host</p><p>数据库主机名</p><p>Ø --database</p><p>数据库名</p><p>Ø --table</p><p>表名</p><p>Ø --client_id</p><p>maxwell-bootstrap 不具备将数据直接导入 kafka 或者 hbase 的能力，通过 --client_id 指定将数据交给哪个 maxwell 进程处理，在 maxwell 的 conf.properties 中配置</p><p><img data-src="C:/Users/ADMINI~1/AppData/Local/Temp/ksohtml9320/wps23.jpg" alt="img"></p></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2021-09-09 14:14:00" itemprop="dateModified" datetime="2021-09-09T14:14:00+08:00">2021-09-09</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="Miyazono 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="Miyazono 支付宝"><p>支付宝</p></div><div><img data-src="/images/paypal.png" alt="Miyazono 贝宝"><p>贝宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Miyazono <i class="ic i-at"><em>@</em></i>冬樱茶</li><li class="link"><strong>本文链接：</strong> <a href="https://github.com/Mayizono/miyazono.github.io/big-data/flink/2_Canal/" title="CDC Canal 的使用">https://github.com/Mayizono/miyazono.github.io/big-data/flink/2_Canal/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/big-data/hive/HQL%E4%B8%8A%E7%BA%BF%E4%BA%BA%E6%95%B0/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipev1x5e4j20zk0m8b29.jpg" title="HQL之同时在线人数"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> Hive</span><h3>HQL之同时在线人数</h3></a></div><div class="item right"><a href="/Day10-%E7%BB%A7%E6%89%BF/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giciub8ja1j20zk0m81ky.jpg" title="Java基础--继承"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i></span><h3>Java基础--继承</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#canal%E5%85%A5%E9%97%A8"><span class="toc-number">1.</span> <span class="toc-text">Canal 入门</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFcanal"><span class="toc-number">1.1.</span> <span class="toc-text">什么是 Canal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.2.</span> <span class="toc-text">使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#canal%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">1.3.</span> <span class="toc-text">Canal 的工作原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mysql%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E8%BF%87%E7%A8%8B"><span class="toc-number">1.4.</span> <span class="toc-text">MySQL 主从复制过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#canal%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86-2"><span class="toc-number">1.5.</span> <span class="toc-text">Canal 的工作原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mysql%E7%9A%84binlog"><span class="toc-number">1.6.</span> <span class="toc-text">MySQL 的 Binlog</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql%E7%9A%84%E5%87%86%E5%A4%87"><span class="toc-number">2.</span> <span class="toc-text">MySQL 的准备</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%AE%9E%E6%97%B6%E4%B8%9A%E5%8A%A1%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">2.1.</span> <span class="toc-text">创建实时业务数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E5%BB%BA%E8%A1%A8%E6%95%B0%E6%8D%AE"><span class="toc-number">2.2.</span> <span class="toc-text">导入建表数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9etcmycnf%E6%96%87%E4%BB%B6"><span class="toc-number">2.3.</span> <span class="toc-text">修改 &#x2F;etc&#x2F;my.cnf 文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#824-%E9%87%8D%E5%90%AFmysql%E4%BD%BF%E9%85%8D%E7%BD%AE%E7%94%9F%E6%95%88"><span class="toc-number">2.4.</span> <span class="toc-text">8**.2.4** 重启 MySQL 使配置生效</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#825-%E6%A8%A1%E6%8B%9F%E7%94%9F%E6%88%90%E6%95%B0%E6%8D%AE"><span class="toc-number">2.5.</span> <span class="toc-text">8**.2.5** 模拟生成数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#826-%E8%B5%8B%E6%9D%83%E9%99%90"><span class="toc-number">2.6.</span> <span class="toc-text">8**.2.6** 赋权限</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#83-canal-%E6%9E%B6%E6%9E%84%E4%BB%A5%E5%8F%8A%E5%AE%89%E8%A3%85"><span class="toc-number">3.</span> <span class="toc-text">8.3 canal 架构以及安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#831-canal%E6%9E%B6%E6%9E%84"><span class="toc-number">3.1.</span> <span class="toc-text">8.3.1 canal 架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#832-canal%E7%9A%84%E4%B8%8B%E8%BD%BD%E5%92%8C%E5%AE%89%E8%A3%85"><span class="toc-number">3.2.</span> <span class="toc-text">8.3.2 canal 的下载和安装</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#84-canal%E5%8D%95%E6%9C%BA%E7%89%88"><span class="toc-number">4.</span> <span class="toc-text">8.4 canal 单机版</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#841-%E4%BF%AE%E6%94%B9confcanalproperties%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-number">4.1.</span> <span class="toc-text">8**.4.1** 修改 conf&#x2F;canal.properties 的配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#842-%E4%BF%AE%E6%94%B9instanceproperties"><span class="toc-number">4.2.</span> <span class="toc-text">8**.4.2** 修改 instance.properties</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#843-%E5%8D%95%E6%9C%BAcanal%E6%B5%8B%E8%AF%95"><span class="toc-number">4.3.</span> <span class="toc-text">8**.4.3** 单机 canal 测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#85-canal%E9%AB%98%E5%8F%AF%E7%94%A8%E4%BA%86%E8%A7%A3"><span class="toc-number">5.</span> <span class="toc-text">8.5 canal 高可用（了解）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#851-%E5%81%9C%E6%AD%A2%E5%8D%95%E6%9C%BAcanal%E8%BF%9B%E7%A8%8B"><span class="toc-number">5.1.</span> <span class="toc-text">8**.5.1** 停止单机 canal 进程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#852-%E5%9C%A8hadoop102%E4%B8%8A%E4%BF%AE%E6%94%B9canalproperties"><span class="toc-number">5.2.</span> <span class="toc-text">8**.5.2** 在 hadoop102 上修改 canal.properties</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#853-%E6%8A%8Acanal%E7%9B%AE%E5%BD%95%E5%88%86%E5%8F%91%E7%BB%99%E5%85%B6%E4%BB%96%E8%99%9A%E6%8B%9F%E6%9C%BA"><span class="toc-number">5.3.</span> <span class="toc-text">8**.5.3** 把 canal 目录分发给其他虚拟机</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#854-%E6%B5%8B%E8%AF%95"><span class="toc-number">5.4.</span> <span class="toc-text">8**.5.4** 测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#86-maxwell%E4%B8%8Ecanal-%E5%B7%A5%E5%85%B7%E5%AF%B9%E6%AF%94"><span class="toc-number">6.</span> <span class="toc-text">8.6 Maxwell 与 Canal 工具对比</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#861%E6%89%A7%E8%A1%8C%E4%B8%8D%E5%90%8C%E6%93%8D%E4%BD%9Cmaxwell%E5%92%8Ccanal%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F%E5%AF%B9%E6%AF%94"><span class="toc-number">6.1.</span> <span class="toc-text">8**.6.1**** 执行不同操作，Maxwell 和 canal 数据格式对比 **</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#862-%E6%80%BB%E7%BB%93%E6%95%B0%E6%8D%AE%E7%89%B9%E7%82%B9"><span class="toc-number">6.2.</span> <span class="toc-text">8**.6.2** 总结数据特点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#87-maxwell%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%E6%95%B0%E6%8D%AE%E5%8A%9F%E8%83%BD"><span class="toc-number">7.</span> <span class="toc-text">8.7 Maxwell 的初始化数据功能</span></a></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/big-data/flink/1_Nginx/" rel="bookmark" title="负载均衡Nginx的使用">负载均衡Nginx的使用</a></li><li class="active"><a href="/big-data/flink/2_Canal/" rel="bookmark" title="CDC Canal的使用">CDC Canal的使用</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Miyazono" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Miyazono</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">25</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">6</span> <span class="name">分类</span></a></div></nav><div class="social"><a href="https://github.com/amehime" title="https:&#x2F;&#x2F;github.com&#x2F;amehime" class="item github"><i class="ic i-github"></i></a> <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9hbWVoaW1l" title="https:&#x2F;&#x2F;twitter.com&#x2F;amehime"><i class="ic i-twitter"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS9ydXJpc216aw==" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;rurismzk"><i class="ic i-zhihu"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTEyODg2ODIz" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;12886823"><i class="ic i-cloud-music"></i></span> <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20vYW1laGltZQ==" title="https:&#x2F;&#x2F;weibo.com&#x2F;amehime"><i class="ic i-weibo"></i></span> <span class="exturl item about" data-url="aHR0cHM6Ly9hYm91dC5tZS9hbWVoaW1l" title="https:&#x2F;&#x2F;about.me&#x2F;amehime"><i class="ic i-address-card"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li><li class="item"><a href="/mikutap/" rel="section"><i class="ic i-star"></i>mikutap</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/big-data/hive/HQL%E4%B8%8A%E7%BA%BF%E4%BA%BA%E6%95%B0/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/Day10-%E7%BB%A7%E6%89%BF/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"></div><span><a href="/big-data/flink/5_%E6%97%A5%E6%B4%BB/" title="未命名">未命名</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/big-data/spark/4.%20Spark%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E2%80%94%E2%80%94%E7%94%B5%E5%95%86%E6%8C%87%E6%A0%87%E7%BB%9F%E8%AE%A1/" title="未命名">未命名</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/big-data/spark/1.Spark%E7%8E%AF%E5%A2%83%E7%9A%84%E5%AE%89%E8%A3%85/" title="未命名">未命名</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/big-data/" title="分类于 大数据">大数据</a> <i class="ic i-angle-right"></i> <a href="/categories/big-data/hive/" title="分类于 Hive">Hive</a></div><span><a href="/big-data/hive/Hive%20%E5%AD%A6%E4%B9%A0/" title="Hive学习">Hive学习</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/big-data/spark/7.SparkStreaming/" title="未命名">未命名</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/big-data/spark/2.Spark%E6%9E%B6%E6%9E%84%E5%8F%8A%E7%BC%96%E7%A8%8B/" title="未命名">未命名</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/big-data/" title="分类于 大数据">大数据</a> <i class="ic i-angle-right"></i> <a href="/categories/big-data/hive/" title="分类于 Hive">Hive</a></div><span><a href="/big-data/hive/HQL%E4%B8%8A%E7%BA%BF%E4%BA%BA%E6%95%B0/" title="HQL之同时在线人数">HQL之同时在线人数</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/big-data/flink/4_Kibana/" title="未命名">未命名</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/big-data/spark/6.SparkSQL/" title="未命名">未命名</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/big-data/" title="分类于 大数据">大数据</a> <i class="ic i-angle-right"></i> <a href="/categories/big-data/flume/" title="分类于 Flume">Flume</a></div><span><a href="/big-data/flume/Flume%E7%BB%83%E4%B9%A0%E9%A2%98/" title="Flume练习题">Flume练习题</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2018 – <span itemprop="copyrightYear">2021</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Miyazono @ Yume Shoka</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">359k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">5:26</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<a href="https://github.com/amehime/hexo-theme-shoka">Shoka</a></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"big-data/flink/2_Canal/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->